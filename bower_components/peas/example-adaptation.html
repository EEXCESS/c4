<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<script src="bower_components/requirejs/require.js"></script>
		<script>
			require(["peas_adapt"], function(peas_adapt){				
				document.getElementById("go").addEventListener("click", function(){ 
					var originalQuery = JSON.parse(document.getElementById("originalQuery").value);
					var policies = JSON.parse(document.getElementById("policies").value);
					if (originalQuery != ""){
						var adaptedQuery = peas_adapt.adaptQuery(originalQuery, policies);
						var adaptedQueryStr = JSON.stringify(adaptedQuery);
						document.getElementById("adaptedQuery").innerHTML = adaptedQueryStr; 
					}
				});
			});
		</script>
	</head>
	<body>
		<form>
			<p>
				Original query: <br/>
				<textarea id="originalQuery" rows="15" cols="150">{
    "partnerList": [{
        "systemId": "Europeana"
    }],
    "protectedPartnerList": [{
        "systemId": "Europeana",
        "partnerKey": "ycz!djklasnbm2ia"
    }],
    "ageRange": 2,
    "numResults": 10,
    "gender": "female",
    "address": {
        "country": "testcountry",
        "city": "testcity"
    },
    "timeRange": {
        "start": "1980",
        "end": "2000"
    },
    "languages": [{
        "iso2": "de",
        "languageCompetenceLevel": 0.1
    }, {
        "iso2": "en",
        "languageCompetenceLevel": 0.1
    }],
    "userCredentials": [{
        "systemId": "Wissenmedia",
        "login": "me@partner.x",
        "securityToken": "sdjalkej21!#"
    }],
    "contextKeywords": [{
        "text": "women",
        "type": "misc",
        "uri": "http://dbpedia.com/resource/woman",
        "isMainTopic": false
    }],
    "context": {
        "reason": "manual",
        "value": "www.wikipedia.at"
    },
    "interests": [{
        "text": "text",
        "weight": 0.1,
        "confidence": 0.1,
        "competenceLevel": 0.1,
        "source": "source",
        "uri": "http://dsjkdjas.de"
    }, {
        "text": "text2",
        "weight": 0.2,
        "confidence": 0.2,
        "competenceLevel": 0.2,
        "source": "source2",
        "uri": "http://google.de"
    }]
}</textarea>

			<p>
				Policies: <br/>
				<textarea id="policies" rows="10" cols="150">[
	{"attribute": "ageRangePolicy", "level": 0},
	{"attribute": "genderPolicy", "level": 0},
	{"attribute": "locationPolicy", "level": 2},
	{"attribute": "interestPolicy0", "level": 1},
	{"attribute": "interestPolicy1", "level": 1},
	{"attribute": "languagePolicy0", "level": 1},
	{"attribute": "languagePolicy1", "level": 1}
]</textarea>
			</p>
			<p>
				<button id="go" type="button">Go!</button>
			</p>
			<p>Adapted query: <span id="adaptedQuery"></span>
		</form>
	</body>
</html>
